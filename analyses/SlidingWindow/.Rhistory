#Read in your datatable from a tab-delimited text file
mydata <- read.delim("fastq_readcounts_forR.txt")
#### HEADER SHOULD BE:(tab delimited)
#filename loci  population
head(mydata)
# Make the plot!!!
ggplot(mydata,aes(x=n_reads, fill = group)) +
geom_histogram(data = mydata, bins= 20) +
facet_wrap(~population) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
######## produce the same plot, separated by population
mydata_kor <- filter(mydata, group == "Korea")
ggplot(mydata_kor,aes(x=th_reads, fill = group)) +
geom_histogram(data = mydata_kor, bins= 20, fill = group) +
facet_wrap(~population) +
xlab("Number of Raw Reads (x 100,000)") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
mutate(th_reads = n_reads/100000)
ggplot(mydata_kor,aes(x=th_reads, fill = group)) +
geom_histogram(data = mydata_kor, bins= 20, fill = group) +
facet_wrap(~population) +
xlab("Number of Raw Reads (x 100,000)") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
ggplot(mydata_kor,aes(x=th_reads)) +
geom_histogram(data = mydata_kor, bins= 20, fill = "deepskyblue4") +
facet_wrap(~population) +
xlab("Number of Raw Reads (x 100,000)") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon")
ggplot(mydata_kor,aes(x=th_reads)) +
geom_histogram(data = mydata_kor, bins= 20, fill = "deepskyblue4") +
facet_wrap(~population) +
xlab("Number of Raw Reads (x 100,000)") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon") %>%
mutate(th_reads = n_reads/100000)
ggplot(mydata_kor,aes(x=th_reads)) +
geom_histogram(data = mydata_kor, bins= 20, fill = "deepskyblue4") +
facet_wrap(~population) +
xlab("Number of Raw Reads (x 100,000)") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(th_reads = n_reads/100000)
ggplot(mydata_kor,aes(x=th_reads)) +
geom_histogram(data = mydata_kor, bins= 20, fill = "deepskyblue4") +
facet_wrap(~population) +
xlab("Number of Raw Reads (x 100,000)") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
mydata <- read.delim("pstacks_loci_counts_b8_forR.txt")
#### HEADER SHOULD BE:(tab delimited)
#filename loci  population
View(mydata)
# Make the plot!!!
# Specify that you don't want scientific notation
options(scipen = 999) #Positive values bias towards fixed and negative towards scientific notation
# Set the bw theme (layout) for ggplot.
theme_set(theme_bw())
# Set working directory
setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/stacks_pipeline_analyses/analyses_AK_LowGenotypeRate/batch8")
#Read in your datatable from a tab-delimited text file
mydata <- read.delim("pstacks_loci_counts_b8_forR.txt")
#### HEADER SHOULD BE:(tab delimited)
#filename loci  population
View(mydata)
# Make the plot!!!
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07")
mydata_ak <- filter(mydata, group == "Alaska")
ggplot(mydata_kor,aes(x=n_loci, fill = group)) +
geom_histogram(data = mydata_kor, bins= 20, fill = "deepskyblue4") +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_ak,aes(x=n_loci)) +
geom_histogram(data = mydata_ak, bins= 20, fill = "mediumorchid2") +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(coast = ifelse(population == "YellowSea16" | population == "Boryeong", "West", "South"))
View(mydata_kor)
ggplot(mydata_kor,aes(x=n_loci, fill = coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_kor,aes(x=n_loci, fill = coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_color_manual("forestgreen", "deepskyblue4")
ggplot(mydata_kor,aes(x=n_loci, fill = coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_color_manual("forestgreen", "deepskyblue4") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_kor,aes(x=n_loci, fill = coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_color_manual(values=c("forestgreen", "deepskyblue4")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_kor,aes(x=n_loci, fill = coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("forestgreen", "deepskyblue4")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(Coast = ifelse(population == "YellowSea16" | population == "Boryeong", "West", "South"))
mydata_ak <- filter(mydata, group == "Alaska")
View(mydata_kor)
ggplot(mydata_kor,aes(x=n_loci, fill = coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("forestgreen", "deepskyblue4")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_kor,aes(x=n_loci, fill = Coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("forestgreen", "deepskyblue4")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(Coast = ifelse(population == "YellowSea16" | population == "Boryeong07", "West", "South"))
ggplot(mydata_kor,aes(x=n_loci, fill = Coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("forestgreen", "deepskyblue4")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_ak,aes(x=n_loci)) +
geom_histogram(data = mydata_ak, bins= 20, fill = "mediumorchid2") +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_kor,aes(x=n_loci, fill = Coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("deepskyblue4", "forestgreen")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
#Read in your datatable from a tab-delimited text file
mydata <- read.delim("fastq_readcounts_forR.txt")
#### HEADER SHOULD BE:(tab delimited)
#filename loci  population
head(mydata)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(Coast = ifelse(population == "YellowSea16" | population == "Boryeong07", "West", "South"))
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(Coast = ifelse(population == "YellowSea16" | population == "Boryeong07", "West", "South")) %>%
mutate(th_reads = n_reads/100000)
setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/stacks_pipeline_analyses")
########################## PSTACKS
#Read in your datatable from a tab-delimited text file
mydata <- read.delim("fastq_readcounts_forR.txt")
#### HEADER SHOULD BE:(tab delimited)
#filename loci  population
head(mydata)
mydata_kor <- mydata %>%
filter(group == "Korea") %>%
filter(population != "Jukbyeon07") %>%
mutate(Coast = ifelse(population == "YellowSea16" | population == "Boryeong07", "West", "South")) %>%
mutate(th_reads = n_reads/100000)
ggplot(mydata_kor,aes(x=n_loci, fill = Coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("deepskyblue4", "forestgreen")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
ggplot(mydata_kor,aes(x=th_reads, fill = Coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Loci Discovered") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("deepskyblue4", "forestgreen")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,27000)
View(mydata_kor)
ggplot(mydata_kor,aes(x=th_reads, fill = Coast)) +
geom_histogram(data = mydata_kor, bins= 20) +
facet_wrap(~population) +
xlab("Number of Raw Reads x 100,000") +
ylab("Number of Individuals") +
scale_fill_manual(values=c("deepskyblue4", "forestgreen")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(axis.text=element_text(size=12), axis.title = element_text(size=12)) +
xlim(0,200)
setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/analyses/SlidingWindow")
all_marker_west <- read.table("West_SWA_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
head(all_marker_west)
marker_west <- select(all_marker_west, c("V1", "V2", "V3"))
colnames(marker_west) <- c("chrom", "position", "num_markers")
head(marker_west)
all_marker_east <- read.table("East_SWA_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
all_marker_east <- read.table("East_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
head(all_marker_east)
marker_east <- select(all_marker_east, c("V1", "V2", "V3"))
colnames(marker_east) <- c("chrom", "position", "num_markers")
head(marker_east)
all_marker <- read.table("EastWest_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
all_marker <- read.table("EastWest_GlobalFst_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
head(all_marker)
marker <- select(all_marker, c("V1", "V2", "V3"))
colnames(marker) <- c("chrom", "position", "num_markers")
head(marker)
marker <- mutate(marker, Analysis  = "All Data")
marker_east <- mutate(marker_east, Analysis = "East")
marker_west <- mutate(marker_west, Analysis = "West")
all_marker_data <- rbind(marker, marker_east, marker_west)
View(all_marker_data)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
facet_wrap(~Analysis)
dim(marker_east)
dim(marker_west)
dim(all_marker_data)
3450*3
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(bins=5) +
facet_wrap(~Analysis)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=5) +
facet_wrap(~Analysis)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=5) +
geom_vline(aes(xintercept=mean(weight)), color="blue", linetype="dashed", size=0.5) +
facet_wrap(~Analysis)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=5) +
geom_vline(aes(xintercept=mean(num_markers)), color="blue", linetype="dashed", size=0.5) +
facet_wrap(~Analysis)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=1) +
geom_vline(aes(xintercept=mean(num_markers)), color="blue", linetype="dashed", size=0.5) +
facet_wrap(~Analysis)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=1) +
facet_wrap(~Analysis)
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=1) +
facet_wrap(~Analysis) +
xlab("Number of Markers per Window") +
ylab("Number of Windows") +
theme(axis.text = element_text(size=10))
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=1) +
facet_wrap(~Analysis) +
xlab("Number of Markers per Window") +
ylab("Number of Windows") +
theme(axis.text = element_text(size=12))
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=1) +
facet_wrap(~Analysis) +
xlab("Number of Markers per Window") +
ylab("Number of Windows") +
theme(axis.text = element_text(size=14))
ggplot(all_marker_data, aes(x=num_markers)) +
geom_histogram() +
stat_bin(binwidth=1) +
facet_wrap(~Analysis) +
xlab("Number of Markers per Window") +
ylab("Number of Windows") +
theme(axis.text = element_text(size=12), axis.title = element_text(size=12))
