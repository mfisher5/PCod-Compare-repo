west_joined <- full_join(west_joined, west_width_perlg, by="chromosome")
west_joined
## east
east_markers_perlg <- east_markers %>%
group_by(chromosome) %>%
summarise(marker_count = length(Locus))
head(east_markers_perlg)
east_islands_perlg <- east_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(east_islands_perlg)
east_width_perlg <- east_islands %>%
group_by(chromosome) %>%
summarise(island_width = mean(windows_per_island))
head(east_width_perlg)
east_islands_perlg$chromosome <- as.character(east_islands_perlg$chromosome)
east_width_perlg$chromosome <- as.character(east_width_perlg$chromosome)
east_joined <- left_join(east_islands_perlg, east_markers_perlg, by="chromosome")
east_joined <- full_join(east_joined, east_width_perlg, by="chromosome")
east_joined
all_marker_island_data <- rbind(mydata_joined, west_joined, east_joined)
dim(all_marker_island_data)
View(all_marker_island_data)
fit <- lm(island_count ~ marker_count, data=all_marker_island_data)
summary(fit)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.2364", x=150,y=1.5, color="lightsteelblue4")
fit <- lm(island_width ~ marker_count, data=all_marker_island_data)
summary(fit)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_width)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1389; p value = 0.003", x=150,y=1.5, color="lightsteelblue4")
ggplot(all_marker_island_data, aes(x=marker_count,y=island_width)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1389; p value = 0.003", x=200,y=9, color="black")
ggplot(all_marker_island_data, aes(x=marker_count,y=island_width)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1389; p value = 0.003", x=200,y=9, color="black", size=12)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_width)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1389; p value = 0.003", x=200,y=9, color="black", size=8)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_width)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1389; p value = 0.003", x=200,y=9, color="black", size=6)
fit <- lm(island_count ~ marker_count, data=all_marker_island_data)
summary(fit)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.2364; p value = 9.97e-5", x=150,y=1.5, color="black", size = 6)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.2364; p value = 9.97e-5", x=150,y=4.5, color="black", size = 6)
library(TTR)
library(zoo) # don't need to install; will install with TTR
setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/analyses/SlidingWindow")
swa_het_output_east <- read.delim("Heterozygosity/batch_8_final_filtered_east_HETEROZYGOSITY_kernel_smoothing_1e+05_bootstraps_sigma_250000_div150.txt")
head(swa_het_output_east)
swa_het_output_west <- read.delim("Heterozygosity/batch_8_final_filtered_west_HETEROZYGOSITY_kernel_smoothing_1e+05_bootstraps_sigma_250000_div150.txt")
head(swa_het_output_west)
source("Plot_SlidingWindowAnalysis_FstHet_Function.R")
swa_output = read.table("EastvWest/batch_8_SWA_eastwest_globalFst_filtered_output_kernel_smoothing_1e+05_bootstraps_sigma_250000_div150_FILTERED.txt", header = TRUE, sep = "\t")
plot_fst_het(data = swa_output,
het1 = swa_het_output_east,
het2 = swa_het_output_west,
legend.text.het1 = "East", legend.text.het2 = "West",
Nb_bootstrap_fst=100000, Nb_divisions_fst = 150,
Nb_bootstrap_het=100000, Nb_divisions_het = 150,
which.chromosome.analysis="all", which.chromosome.plot="all",
export = TRUE, name="plots/EastWest/EastvWest_Het_filtered_avg")
source("Plot_SlidingWindowAnalysis_FstHet_Function.R")
plot_fst_het(data = swa_output,
het1 = swa_het_output_east,
het2 = swa_het_output_west,
legend.text.het1 = "East", legend.text.het2 = "West",
Nb_bootstrap_fst=100000, Nb_divisions_fst = 150,
Nb_bootstrap_het=100000, Nb_divisions_het = 150,
which.chromosome.analysis="all", which.chromosome.plot="all",
export = TRUE, name="plots/EastWest/EastvWest_Het_filtered_avg")
source("Plot_SlidingWindowAnalysis_Functions.R")
plot_fst_het(data = swa_output,
het1 = swa_het_output_east,
het2 = swa_het_output_west,
legend.text.het1 = "East", legend.text.het2 = "West",
Nb_bootstrap_fst=100000, Nb_divisions_fst = 150,
Nb_bootstrap_het=100000, Nb_divisions_het = 150,
which.chromosome.analysis="all", which.chromosome.plot="all",
export = TRUE, name="plots/EastWest/EastvWest_Het_filtered_avg")
library(readr)
library(ggplot2)
library(dplyr)
# Load Data -------------------------------------------------------------
setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/analyses/SlidingWindow")
## east & west
mydata_islands <- read_delim("batch_8_eastwest_islands.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(mydata_islands)
colnames(mydata_islands) <- c("chromosome", "windows_per_island")
mydata_markers <- read_delim("EastvWest/batch_8_SWA_input_eastwest_globalFst_filtered_sorted.txt","\t", escape_double = FALSE, trim_ws = TRUE)
head(mydata_markers)
## west (note had to select out columns b/c i also had start & end positions in dataframe)
west_islands <- read_delim("batch_8_west_islands.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(west_islands)
colnames(west_islands) <- c("chromosome", "windows_per_island", "start", "end")
west_islands <- select(west_islands, chromosome, windows_per_island)
head(west_islands)
west_markers <- read_delim("West/batch_8_SWA_input_west_sorted.txt","\t", escape_double = FALSE, trim_ws = TRUE)
head(west_markers)
## east
east_islands <- read_delim("batch_8_east_islands.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(east_islands)
colnames(east_islands) <- c("chromosome", "windows_per_island", "start", "end")
east_islands <- select(east_islands, chromosome, windows_per_island)
head(east_islands)
east_markers <- read_delim("East/batch_8_SWA_input_east_sorted.txt","\t", escape_double = FALSE, trim_ws = TRUE)
head(east_markers)
# Calculate markers / islands per linkage group -------------------------------------
## count number of islands / markers per chromosome
mydata_markers_perlg <- mydata_markers %>%
group_by(chromosome) %>%
summarise(marker_count = length(Locus))
head(mydata_markers_perlg)
mydata_islands_perlg <- mydata_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(mydata_islands_perlg)
mydata_width_perlg <- mydata_islands %>%
group_by(chromosome) %>%
summarise(island_width = mean(windows_per_island))
head(mydata_width_perlg)
## join data frames by loci (left join b/c not all chromosomes have islands)
mydata_islands_perlg$chromosome <- as.character(mydata_islands_perlg$chromosome)
mydata_width_perlg$chromosome <- as.character(mydata_width_perlg$chromosome)
mydata_joined <- left_join(mydata_islands_perlg, mydata_markers_perlg, by="chromosome")
mydata_joined <- full_join(mydata_joined, mydata_width_perlg, by="chromosome")
mydata_joined
## west
west_markers_perlg <- west_markers %>%
group_by(chromosome) %>%
summarise(marker_count = length(Locus))
head(west_markers_perlg)
west_islands_perlg <- west_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(west_islands_perlg)
west_width_perlg <- west_islands %>%
group_by(chromosome) %>%
summarise(island_width = mean(windows_per_island))
head(west_width_perlg)
west_islands_perlg$chromosome <- as.character(west_islands_perlg$chromosome)
west_width_perlg$chromosome <- as.character(west_width_perlg$chromosome)
west_joined <- left_join(west_islands_perlg, west_markers_perlg, by="chromosome")
west_joined <- full_join(west_joined, west_width_perlg, by="chromosome")
west_joined
## east
east_markers_perlg <- east_markers %>%
group_by(chromosome) %>%
summarise(marker_count = length(Locus))
head(east_markers_perlg)
east_islands_perlg <- east_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(east_islands_perlg)
east_width_perlg <- east_islands %>%
group_by(chromosome) %>%
summarise(island_width = mean(windows_per_island))
head(east_width_perlg)
east_islands_perlg$chromosome <- as.character(east_islands_perlg$chromosome)
east_width_perlg$chromosome <- as.character(east_width_perlg$chromosome)
east_joined <- left_join(east_islands_perlg, east_markers_perlg, by="chromosome")
east_joined <- full_join(east_joined, east_width_perlg, by="chromosome")
east_joined
## overall
all_marker_island_data <- rbind(mydata_joined, west_joined, east_joined)
dim(all_marker_island_data)
View(all_marker_island_data)
# Plot Number Islands v. Number Markers -----------------------------------
fit <- lm(island_count ~ marker_count, data=mydata_joined)
summary(fit)
ggplot(mydata_joined, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1907", x=150,y=1.5, color="lightsteelblue4")
## west
fit <- lm(island_count ~ marker_count, data=west_joined)
summary(fit)
ggplot(west_joined, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.0152", x=100,y=1.5, color="lightsteelblue4")
## east
fit <- lm(island_count ~ marker_count, data=east_joined)
summary(fit)
ggplot(east_joined, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1951", x=140,y=2.25, color="lightsteelblue4")
## all
fit <- lm(island_count ~ marker_count, data=all_marker_island_data)
summary(fit)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Number of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.2364; p value = 9.97e-5", x=150,y=4.5, color="black", size = 6)
# Plot Width of Islands v. Number Markers ---------------------------------
fit <- lm(island_width ~ marker_count, data=mydata_joined)
summary(fit)
ggplot(mydata_joined, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands (N windows)") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.0012", x=150,y=1.5, color="lightsteelblue4")
## west
fit <- lm(island_width ~ marker_count, data=west_joined)
summary(fit)
ggplot(west_joined, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands (N windows)") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.4487", x=150,y=1.5, color="lightsteelblue4")
## east
fit <- lm(island_width ~ marker_count, data=east_joined)
summary(fit)
ggplot(east_joined, aes(x=marker_count,y=island_count)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands (N windows)") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.024", x=150,y=1.5, color="lightsteelblue4")
## all
fit <- lm(island_width ~ marker_count, data=all_marker_island_data)
summary(fit)
ggplot(all_marker_island_data, aes(x=marker_count,y=island_width)) +
geom_point(size=2) +
xlab("Number of Markers") +
ylab("Width of Islands") +
theme(axis.text=element_text(size=16), axis.title=element_text(size=20)) +
geom_smooth(method="lm", se=F, linetype = 2, color="lightsteelblue4", size=0.6) +
annotate("text", label="R-squared:0.1389; p value = 0.003", x=200,y=9, color="black", size=6)
View(east_islands)
View(east_islands_perlg)
setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/analyses/SlidingWindow")
## east & west
mydata_islands <- read_delim("batch_8_eastwest_islands.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(mydata_islands)
colnames(mydata_islands) <- c("chromosome", "windows_per_island")
## west (note had to select out columns b/c i also had start & end positions in dataframe)
west_islands <- read_delim("batch_8_west_islands.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(west_islands)
colnames(west_islands) <- c("chromosome", "windows_per_island", "start", "end")
west_islands <- select(west_islands, chromosome, windows_per_island)
head(west_islands)
## east
east_islands <- read_delim("batch_8_east_islands.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(east_islands)
colnames(east_islands) <- c("chromosome", "windows_per_island", "start", "end")
east_islands <- select(east_islands, chromosome, windows_per_island)
head(east_islands)
mydata_islands_perlg <- mydata_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(mydata_islands_perlg)
## west
west_islands_perlg <- west_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(west_islands_perlg)
## east
east_islands_perlg <- east_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(east_islands_perlg)
islands_per_lg <- full_join(mydata_islands_perlg, west_islands_perlg)
islands_per_lg <- full_join(mydata_islands_perlg, west_islands_perlg, by = "chromosome")
islands_per_leg <- full_join(islands_per_lg, east_islands_perlg, by="chromosome")
head(islands_per_leg)
head(islands_per_lg)
colnames(islands_per_lg) <- c("chromosome", "fulldata_count", "west_count")
islands_per_lg <- full_join(islands_per_lg, east_islands_perlg, by="chromosome")
head(islands_per_leg)
head(islands_per_lg)
mydata_islands_perlg
mydata_islands_perlg <- mydata_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(mydata_islands_perlg)
## west
west_islands_perlg <- west_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(west_islands_perlg)
## east
east_islands_perlg <- east_islands %>%
group_by(chromosome) %>%
summarise(island_count = length(windows_per_island))
head(east_islands_perlg)
islands_per_lg <- full_join(mydata_islands_perlg, west_islands_perlg, by = "chromosome")
head(islands_per_lg)
colnames(islands_per_lg) <- c("chromosome", "fulldata_count", "west_count")
head(islands_per_lg)
islands_per_lg <- full_join(islands_per_lg, east_islands_perlg, by="chromosome")
head(islands_per_leg)
head(islands_per_lg)
ggplot(islands_per_lg, aes(x=chromosome, y=fulldata_count)) +
geom_col()
islands_per_lg_melted <- melt(islands_per_lg)
library(reshape2)
islands_per_lg_melted <- melt(islands_per_lg)
islands_per_lg_melted
ggplot(islands_per_lg, aes(x=chromosome, y=value, fill=variable)) +
geom_col(position=stack)
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col(position=stack)
islands_per_lg_melted
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col(stat="identity")
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col(stat="identity") +
theme(axis.text.x = element_blank(), axis.title.y=element_text(size=12), axis.title.x = element_text(size=12))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.title.y=element_text(size=12), axis.title.x = element_text(size=12))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_color_manual(values=c("darkgrey", "darkskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("darkgrey", "darkskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("darkgrey", "deepskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("black", "deepskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("darkgrey2", "deepskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("darkgrey4", "deepskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"), labels=c("All Data", "West", "East"))
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"), labels=c("All Data", "West", "East"), name="Data Set")
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16), legend.text=element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"), labels=c("All Data", "West", "East"), name="Data Set")
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16), legend.text=element_text(size=16), legend.title = element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"), labels=c("All Data", "West", "East"), name="Data Set")
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16), legend.text=element_text(size=16), legend.title = element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"), labels=c("All Data", "West", "East"), name="Analysis")
ggplot(islands_per_lg_melted, aes(x=chromosome, y=value, fill=variable)) +
geom_col() +
ylab("Number of Islands") +
xlab("Linkage Group") +
theme(axis.text.x = element_blank(), axis.text.y = element_text(size=16), axis.title.y=element_text(size=16), axis.title.x = element_text(size=16), legend.text=element_text(size=16), legend.title = element_text(size=16)) +
scale_fill_manual(values=c("grey48", "deepskyblue4", "mediumorchid2"), labels=c("All Data", "West", "East"), name="Analysis")
all_marker_data <- read.table("EastWest_GlobalFst_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
head(all_marker_data)
mydata_markers <- select(all_marker_data, c("V1", "V2", "V3"))
colnames(mydata_markers) <- c("chromosome", "position", "num_markers")
eastwest <- read_delim("EastvWest/batch_8_SWA_eastwest_output_kernel_smoothing_1e+05_bootstraps_sigma_250000_div150.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(eastwest)
eastwest_selection <- eastwest %>%
mutate(positive = ifelse(`Fst/Fct` > upper_95, "1", "0")) %>%
mutate(negative = ifelse(`Fst/Fct` < lower_95, "1", "0")) %>%
mutate(selection = ifelse(positive == 1 | negative == 1, "Yes", "No"))
head(eastwest_selection)
mydata_joined <- full_join(eastwest_selection, mydata_markers, by="position")
head(mydata_joined)
mydata_joined <- select(mydata_joined, c(chromosome.x, position, selection, num_markers))
head(mydata_joined)
ggplot(mydata_joined, aes(x=selection, y=num_markers, fill = selection)) +
geom_boxplot() +
xlab("Does Window exceed 95% Confidence Interval?") +
ylab("Number of Markers per Window") +
theme(axis.title=element_text(size=16))
mydata_joined_noNA <- filter(mydata_joined, selection!= NA)
ggplot(mydata_joined_noNA, aes(x=selection, y=num_markers, fill = selection)) +
geom_boxplot() +
xlab("Does Window exceed 95% Confidence Interval?") +
ylab("Number of Markers per Window") +
theme(axis.title=element_text(size=16), axis.text.y)
ggplot(mydata_joined_noNA, aes(x=selection, y=num_markers, fill = selection)) +
geom_boxplot() +
xlab("Does Window exceed 95% Confidence Interval?") +
ylab("Number of Markers per Window") +
theme(axis.title=element_text(size=16), axis.text.y = element_text(size=16))
head(mydata_joined_noNA)
mydata_joined_noNA <- filter(mydata_joined, num_markers != NA)
head(mydata_joined_noNA)
mydata_joined_noNA <- filter(mydata_joined, is.na(selection) == FALSE)
head(mydata_joined_noNA)
ggplot(mydata_joined_noNA, aes(x=selection, y=num_markers, fill = selection)) +
geom_boxplot() +
xlab("Does Window exceed 95% Confidence Interval?") +
ylab("Number of Markers per Window") +
theme(axis.title=element_text(size=16), axis.text.y = element_text(size=16))
all_marker_data <- read.table("West_SWA_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
head(all_marker_data)
west_markers <- select(all_marker_data, c("V1", "V2", "V3"))
colnames(west_markers) <- c("chromosome", "position", "num_markers")
west <- read_delim("West/batch_8_final_filtered_west_2reg_kernel_smoothing_1e+05_bootstraps_sigma_250000_div150.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(west)
west_selection <- west %>%
mutate(positive = ifelse(`Fst/Fct` > upper_95, "1", "0")) %>%
mutate(negative = ifelse(`Fst/Fct` < lower_95, "1", "0")) %>%
mutate(selection = ifelse(positive == 1 | negative == 1, "Yes", "No"))
head(west_selection)
west_joined <- full_join(west_selection, west_markers, by="position")
head(west_joined)
west_joined <- select(west_joined, c(chromosome.x, position, selection, num_markers))
head(west_joined)
west_joined_noNA <- filter(west_joined, is.na(selection) == FALSE)
head(west_joined_noNA)
ggplot(west_joined_noNA, aes(x=selection, y=num_markers, fill = selection)) +
geom_boxplot() +
xlab("Does Window exceed 95% Confidence Interval?") +
ylab("Number of Markers per Window") +
theme(axis.title=element_text(size=16), axis.text.y = element_text(size=16))
all_marker_data <- read.table("East_Num_Name_Loci_Per_Window.txt", header=FALSE, sep="\t")
head(all_marker_data)
east_markers <- select(all_marker_data, c("V1", "V2", "V3"))
colnames(east_markers) <- c("chromosome", "position", "num_markers")
east <- read_delim("East/batch_8_final_filtered_east_globalFst_kernel_smoothing_1e+05_bootstraps_sigma_250000_div150.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
head(east)
east_selection <- east %>%
mutate(positive = ifelse(`Fst/Fct` > upper_95, "1", "0")) %>%
mutate(negative = ifelse(`Fst/Fct` < lower_95, "1", "0")) %>%
mutate(selection = ifelse(positive == 1 | negative == 1, "Yes", "No"))
head(east_selection)
east_joined <- full_join(east_selection, east_markers, by="position")
head(east_joined)
east_joined <- select(east_joined, c(chromosome.x, position, selection, num_markers))
head(east_joined)
east_joined_noNA <- filter(east_joined, is.na(selection) == FALSE)
head(east_joined_noNA)
ggplot(east_joined_noNA, aes(x=selection, y=num_markers, fill = selection)) +
geom_boxplot() +
xlab("Does Window exceed 95% Confidence Interval?") +
ylab("Number of Markers per Window") +
theme(axis.title=element_text(size=16), axis.text.y = element_text(size=16))
