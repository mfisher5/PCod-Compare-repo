setwd("D:/Pacific cod/DataAnalysis/PCod-Compare-repo/analyses/Outliers/OutFLANK")
library(devtools)
source("http://bioconductor.org/biocLite.R")
biocLite("qvalue")
install_github("whitlock/OutFLANK", force = TRUE)
library(OutFLANK)
source("https://raw.githubusercontent.com/whitlock/OutFLANK/master/R/Fst%20Diploids.R")
loci <- read.table("batch_8_eastwest_SNPmat_locusnames.txt", header=F)
pops <- read.table("batch_8_eastwest_SNPmat_popnames.txt", header=F)
data = read.csv("batch_8_eastwest_SNPmat.txt", header = FALSE, sep = "\t")
datamat = as.matrix(data)
View(datamat)
View(loci)
FstDataFrame <- MakeDiploidFSTMat(SNPmat = data, locusNames = loci, popNames = pops)
View(FstDataFrame)
mydata.outflank <- OutFLANK(FstDataFrame, LeftTrimFraction=0.05, RightTrimFraction=0.05, Hmin=0.1, NumberOfSamples=12, qthreshold=0.10)
mydata.outflank <- OutFLANK(FstDataFrame, LeftTrimFraction=0.05, RightTrimFraction=0.05, Hmin=0.1, NumberOfSamples=12, qthreshold=0.05)
loci <- read.table("batch_8_west_SNPmat_locusnames.txt", header=F)
pops <- read.table("batch_8_west_SNPmat_popnames.txt", header=F)
data = read.csv("batch_8_west_SNPmat.txt", header = FALSE, sep = "\t")
datamat = as.matrix(data)
FstDataFrame <- MakeDiploidFSTMat(SNPmat = data, locusNames = loci, popNames = pops)
mydata.outflank <- OutFLANK(FstDataFrame, LeftTrimFraction=0.05, RightTrimFraction=0.05, Hmin=0.1, NumberOfSamples=6, qthreshold=0.05)
dim(mydata.outflank$results[which(mydata.outflank$results$OutlierFlag==T),]) # how many outliers do you have? 1st #
loci <- read.table("batch_8_west_bypop_SNPmat_locusnames.txt", header=F)
pops <- read.table("batch_8_west_bypop_SNPmat_popnames.txt", header=F)
data = read.csv("batch_8_west_bypop_SNPmat.txt", header = FALSE, sep = "\t")
datamat = as.matrix(data)
FstDataFrame <- MakeDiploidFSTMat(SNPmat = data, locusNames = loci, popNames = pops)
mydata.outflank <- OutFLANK(FstDataFrame, LeftTrimFraction=0.05, RightTrimFraction=0.05, Hmin=0.1, NumberOfSamples=6, qthreshold=0.05)
# take a look at the output!
head(mydata.outflank)
typeof(mydata.outflank) # spoiler: it's a list.
dim(mydata.outflank$results[which(mydata.outflank$results$OutlierFlag==T),]) # how many outliers do you have? 1st #
head(mydata.outflank$results)
head(mydata.outflank$results)
outlier_indices <- which(mydata.outflank$results$OutlierFlag == "TRUE")
locus <- c()
he <- c()
fst <-c ()
meanAlleleFreq <- c()
qvals <- c()
pv <- c()
outlier <- c()
for(i in outlier_indices){
locus <- c(locus, mydata.outflank$results$LocusName[i])
he <- c(he, mydata.outflank$results$He[i])
fst <- c(fst, mydata.outflank$results$FST[i])
meanAlleleFreq <- c(meanAlleleFreq, mydata.outflank$results$meanAlleleFreq[i])
qvals <- c(qvals, mydata.outflank$results$qvalues[i])
pv <- c(pv, mydata.outflank$results$pvalues[i])
outlier <- c(outlier, mydata.outflank$results$OutlierFlag[i])
}
#write out to csv file
dataframe <- cbind(locus, he, fst, meanAlleleFreq, qvals, pv, outlier)
write.csv(dataframe, file="batch_8_west_bypop_outflank_outliers.csv", row.names = FALSE)
locus <- c()
he <- c()
fst <-c ()
meanAlleleFreq <- c()
qvals <- c()
pv <- c()
outlier <- c()
for(i in outlier_indices){
locus <- c(locus, mydata.outflank$results$LocusName[i])
print(mydata.outflank$results$LocusName[i])
he <- c(he, mydata.outflank$results$He[i])
fst <- c(fst, mydata.outflank$results$FST[i])
meanAlleleFreq <- c(meanAlleleFreq, mydata.outflank$results$meanAlleleFreq[i])
qvals <- c(qvals, mydata.outflank$results$qvalues[i])
pv <- c(pv, mydata.outflank$results$pvalues[i])
outlier <- c(outlier, mydata.outflank$results$OutlierFlag[i])
}
locus
for(i in outlier_indices){
locus <- c(locus, as.character(mydata.outflank$results$LocusName[i]))
print(mydata.outflank$results$LocusName[i])
he <- c(he, mydata.outflank$results$He[i])
fst <- c(fst, mydata.outflank$results$FST[i])
meanAlleleFreq <- c(meanAlleleFreq, mydata.outflank$results$meanAlleleFreq[i])
qvals <- c(qvals, mydata.outflank$results$qvalues[i])
pv <- c(pv, mydata.outflank$results$pvalues[i])
outlier <- c(outlier, mydata.outflank$results$OutlierFlag[i])
}
locus
locus <- c()
he <- c()
fst <-c ()
meanAlleleFreq <- c()
qvals <- c()
pv <- c()
outlier <- c()
for(i in outlier_indices){
locus <- c(locus, as.character(mydata.outflank$results$LocusName[i]))
print(mydata.outflank$results$LocusName[i])
he <- c(he, mydata.outflank$results$He[i])
fst <- c(fst, mydata.outflank$results$FST[i])
meanAlleleFreq <- c(meanAlleleFreq, mydata.outflank$results$meanAlleleFreq[i])
qvals <- c(qvals, mydata.outflank$results$qvalues[i])
pv <- c(pv, mydata.outflank$results$pvalues[i])
outlier <- c(outlier, mydata.outflank$results$OutlierFlag[i])
}
locus
dataframe <- cbind(locus, he, fst, meanAlleleFreq, qvals, pv, outlier)
write.csv(dataframe, file="batch_8_west_bypop_outflank_outliers.csv", row.names = FALSE, quote=FALSE)
loci <- read.table("batch_8_east_SNPmat_locusnames.txt", header=F)
pops <- read.table("batch_8_east_SNPmat_popnames.txt", header=F)
data = read.csv("batch_8_east_SNPmat.txt", header = FALSE, sep = "\t")
datamat = as.matrix(data)
FstDataFrame <- MakeDiploidFSTMat(SNPmat = data, locusNames = loci, popNames = pops)
mydata.outflank <- OutFLANK(FstDataFrame, LeftTrimFraction=0.05, RightTrimFraction=0.05, Hmin=0.1, NumberOfSamples=6, qthreshold=0.05)
# take a look at the output!
typeof(mydata.outflank) # spoiler: it's a list.
dim(mydata.outflank$results[which(mydata.outflank$results$OutlierFlag==T),]) # how many outliers do you have? 1st #
head(mydata.outflank$results)
outlier_indices <- which(mydata.outflank$results$OutlierFlag == "TRUE")
locus <- c()
he <- c()
fst <-c ()
meanAlleleFreq <- c()
qvals <- c()
pv <- c()
outlier <- c()
for(i in outlier_indices){
locus <- c(locus, as.character(mydata.outflank$results$LocusName[i]))
print(as.character(mydata.outflank$results$LocusName[i]))
he <- c(he, mydata.outflank$results$He[i])
fst <- c(fst, mydata.outflank$results$FST[i])
meanAlleleFreq <- c(meanAlleleFreq, mydata.outflank$results$meanAlleleFreq[i])
qvals <- c(qvals, mydata.outflank$results$qvalues[i])
pv <- c(pv, mydata.outflank$results$pvalues[i])
outlier <- c(outlier, mydata.outflank$results$OutlierFlag[i])
}
#write out to csv file
dataframe <- cbind(locus, he, fst, meanAlleleFreq, qvals, pv, outlier)
write.csv(dataframe, file="batch_8_east_bypop_outflank_outliers.csv", row.names = FALSE, quote=FALSE)
